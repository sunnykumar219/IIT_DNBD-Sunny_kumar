<!DOCTYPE html>
<html>
<head>
  <title>Sunny Voice Bot</title>
</head>
<body style="text-align:center;margin-top:100px;font-family:sans-serif">
  <h2>Talk to Sunny ðŸŽ¤</h2>
  <button onclick="startListening()" style="font-size:20px">Ask Question</button>
  <p id="status"></p>

<script>
let recognition;

function startListening() {
  recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  recognition.lang = "en-IN";
  recognition.start();

  document.getElementById("status").innerText = "Listening...";

  recognition.onresult = async function(event) {
    const question = event.results[0][0].transcript;
    document.getElementById("status").innerText = "You: " + question;

    const res = await fetch("/ask", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ question })
    });

    const data = await res.json();

    const utter = new SpeechSynthesisUtterance(data.answer);
    speechSynthesis.speak(utter);
  };

  recognition.onerror = function() {
    document.getElementById("status").innerText = "Mic error. Please allow microphone.";
  };
}
</script>
</body>
</html>
